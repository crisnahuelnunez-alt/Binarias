<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente de Inversi√≥n Estrat√©gica</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- Variables de Color y Estilos Base --- */
        :root {
            --color-background-start: #1a1a2e; /* Azul oscuro */
            --color-background-mid: #16213e;   /* Azul medio */
            --color-background-end: #0f3460;    /* Azul petr√≥leo */
            --color-primary: #00d4ff;           /* Cian vibrante */
            --color-secondary: #00ff88;         /* Verde esmeralda */
            --color-tertiary: #a0a0a0;          /* Gris para texto mutado */
            --color-text-light: #e0e0e0;        /* Texto claro */
            --color-text-dark: #333;            /* Texto oscuro para botones */
            --color-card-background: rgba(22, 33, 62, 0.75); /* Fondo de tarjeta semitransparente */
            --color-card-border: rgba(255, 255, 255, 0.15); /* Borde de tarjeta sutil */
            --color-input-background: rgba(0, 0, 0, 0.3); /* Fondo de input oscuro */
            --color-win: #28a745;               /* Verde para ganancia */
            --color-loss: #dc3545;              /* Rojo para p√©rdida */
            --color-warning: #ffc107;           /* Amarillo para advertencias */
            --border-radius-main: 15px;         /* Radio de borde principal */
            --border-radius-sm: 8px;            /* Radio de borde peque√±o */
            --font-family-main: 'Poppins', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-main);
            background: linear-gradient(135deg, var(--color-background-start), var(--color-background-mid), var(--color-background-end));
            color: var(--color-text-light);
            min-height: 100vh;
            padding: 30px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            font-size: 16px;
            line-height: 1.6;
        }

        /* --- Contenedor Principal --- */
        .container {
            max-width: 960px;
            width: 100%;
            margin: 0 auto;
        }

        /* --- Cabecera --- */
        .header {
            text-align: center;
            margin-bottom: 50px;
        }

        .header h1 {
            font-size: 3.2em;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1.5px;
            text-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }
        
        .header p {
            font-size: 1.2em;
            color: var(--color-tertiary);
            max-width: 600px;
            margin: 0 auto;
        }

        /* --- Tarjetas (Cards) --- */
        .card {
            background: var(--color-card-background);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--color-card-border);
            border-radius: var(--border-radius-main);
            padding: 35px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
            margin-bottom: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
        }

        .card h2 {
            margin-bottom: 30px;
            color: var(--color-primary);
            font-size: 1.8em;
            font-weight: 700;
            border-bottom: 1px solid var(--color-card-border);
            padding-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .card h2 .icon {
            font-size: 1.2em;
            color: var(--color-secondary);
        }

        /* --- Formularios y Campos de Entrada --- */
        .input-group {
            margin-bottom: 25px;
            width: 100%;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--color-tertiary);
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-group input {
            width: 100%;
            padding: 16px;
            border: 1px solid transparent;
            border-radius: var(--border-radius-sm);
            background: var(--color-input-background);
            color: var(--color-text-light);
            font-size: 1.05em;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 18px rgba(0, 212, 255, 0.3);
            background: rgba(0, 0, 0, 0.4);
        }
        
        .split-inputs {
            display: flex;
            gap: 25px;
            flex-wrap: wrap; /* Permite que los inputs se envuelvan en pantallas peque√±as */
        }
        .split-inputs .input-group {
            flex: 1; /* Hace que los inputs ocupen el espacio disponible */
            min-width: 280px; /* Asegura que no se hagan demasiado peque√±os */
        }

        /* --- Botones --- */
        .btn, .btn-primary {
            color: var(--color-text-dark);
            border: none;
            padding: 18px 35px;
            border-radius: var(--border-radius-sm);
            font-size: 1.15em;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
            box-shadow: 0 6px 25px rgba(0, 230, 172, 0.25);
        }
        .btn-primary:hover {
            box-shadow: 0 10px 30px rgba(0, 230, 172, 0.4);
        }

        .btn:hover, .btn-primary:hover {
            transform: translateY(-5px) scale(1.01);
            opacity: 0.98;
        }
        
        .btn-win { background-color: var(--color-win); color: white; }
        .btn-loss { background-color: var(--color-loss); color: white; }
        .btn-resume { background: var(--color-warning); color: var(--color-text-dark); }
        .btn-reset { background: #6c757d; color: white; }

        /* --- Panel en Vivo y Mensajes --- */
        .live-panel { text-align: center; }

        .live-panel h3 {
            font-size: 1.2em;
            color: var(--color-tertiary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .investment-amount {
            font-size: 4.5em;
            font-weight: 800;
            background: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            line-height: 1.2;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }
        
        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .action-buttons .btn {
            margin-top: 0; /* Anula el margin-top de .btn */
        }
        
        #session-end-message {
            font-size: 2.5em;
            font-weight: 700;
            padding: 50px 30px;
            border-radius: var(--border-radius-main);
            text-align: center;
            letter-spacing: 0.8px;
            margin-top: 20px;
        }

        .victory-message {
            color: var(--color-secondary);
            background: rgba(0, 255, 136, 0.15);
            border: 1px solid var(--color-secondary);
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
        }

        .loss-message {
            color: var(--color-loss);
            background: rgba(220, 53, 69, 0.15);
            border: 1px solid var(--color-loss);
            text-shadow: 0 0 15px rgba(220, 53, 69, 0.6);
        }

        /* --- Tabla de Historial --- */
        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius-main);
            overflow: hidden;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
        }

        th, td {
            padding: 18px;
            text-align: center;
            border-bottom: 1px solid var(--color-card-border);
        }
        
        tr:last-child td {
            border-bottom: none;
        }

        th {
            background: rgba(0, 0, 0, 0.3);
            color: var(--color-primary);
            font-weight: 700;
            font-size: 1em;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .win-row { background: rgba(0, 255, 136, 0.1); }
        .loss-row { background: rgba(255, 0, 68, 0.1); }
        
        .hidden { display: none; }

        /* --- Warning de Riesgo --- */
        .risk-warning {
            background: rgba(255, 193, 7, 0.15); /* Amarillo semi-transparente */
            border: 1px solid var(--color-warning);
            border-radius: var(--border-radius-sm);
            padding: 20px;
            margin-bottom: 30px;
            color: var(--color-warning);
            font-size: 0.95em;
            line-height: 1.5;
            text-align: left;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.1);
        }
        .risk-warning strong {
            color: #fff;
            font-weight: 700;
        }
        .risk-warning ul {
            margin-top: 10px;
            margin-left: 20px;
            list-style: disc;
        }
        .risk-warning li {
            margin-bottom: 5px;
        }

        /* --- Media Queries para Responsividad --- */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.5em; }
            .header p { font-size: 1em; }
            .card { padding: 25px; }
            .card h2 { font-size: 1.5em; }
            .input-group input { padding: 12px; font-size: 0.95em; }
            .btn, .btn-primary { padding: 14px 25px; font-size: 1em; }
            .investment-amount { font-size: 3.5em; }
            .action-buttons { flex-direction: column; gap: 15px; }
            #session-end-message { font-size: 1.8em; padding: 30px 15px; }
            th, td { padding: 12px; font-size: 0.9em; }
            .split-inputs { flex-direction: column; gap: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Asistente de Inversi√≥n Estrat√©gica</h1>
            <p>Planifica tus operaciones de opciones binarias con disciplina y gesti√≥n de riesgo.</p>
        </div>

        <div id="setup-card" class="card">
            <h2><span class="icon">‚öôÔ∏è</span> Plan de Sesi√≥n</h2>
            
            <div class="risk-warning">
                <strong>Advertencia de Riesgo:</strong> El trading de opciones binarias es altamente especulativo y conlleva un riesgo considerable de p√©rdida. Es crucial que entiendas estos riesgos:
                <ul>
                    <li>Puedes perder todo el capital invertido si el mercado se mueve en tu contra.</li>
                    <li>Este asistente es una herramienta de gesti√≥n de riesgo; no garantiza ganancias.</li>
                    <li>Opera solo con dinero que puedas permitirte perder.</li>
                </ul>
                La gesti√≥n de riesgo es clave para proteger tu capital.
            </div>

            <div class="split-inputs">
                <div class="input-group">
                    <label for="balance">Balance de Sesi√≥n ($)</label>
                    <input type="number" id="balance" value="100" min="1">
                </div>
                <div class="input-group">
                    <label for="minInvestment">Inversi√≥n M√≠nima ($)</label>
                    <input type="number" id="minInvestment" value="1" step="0.01" min="0.01">
                </div>
            </div>
            <div class="split-inputs">
                <div class="input-group">
                    <label for="sessionProfitGoal">Take Profit / Meta de Ganancia (%)</label>
                    <input type="number" id="sessionProfitGoal" value="20" min="1">
                </div>
                <div class="input-group">
                    <label for="stopLossPercent">Stop-Loss / L√≠mite de P√©rdida (%)</label>
                    <input type="number" id="stopLossPercent" value="25" min="1">
                </div>
            </div>
            <div class="split-inputs">
                <div class="input-group">
                    <label for="winRate">Tasa de Ganancia (%)</label>
                    <input type="number" id="winRate" value="80" step="0.1">
                </div>
                <div class="input-group">
                    <label for="winsNeeded">Operaciones a Ganar</label>
                    <input type="number" id="winsNeeded" value="4" min="1">
                </div>
            </div>
             <div class="input-group">
                <label for="totalOps">M√°ximo de Operaciones</label>
                <input type="number" id="totalOps" value="15" min="1">
            </div>
            <button class="btn-primary" id="startBtn">‚ñ∂Ô∏è Comenzar Sesi√≥n</button>
            <button class="btn btn-resume hidden" id="resumeBtn">üîÑ Retomar Sesi√≥n Anterior</button>
        </div>

        <div id="live-card" class="card hidden">
             <h2><span class="icon">üî¥</span> Panel de Operaci√≥n en Vivo</h2>
            <div id="live-panel-content" class="live-panel">
                <h3 id="operation-label"></h3>
                <div id="investment-amount" class="investment-amount"></div>
                <div class="action-buttons">
                    <button class="btn btn-win" id="winBtn">Gan√© ‚úÖ</button>
                    <button class="btn btn-loss" id="lossBtn">Perd√≠ ‚ùå</button>
                </div>
            </div>
            <div id="session-end-message" class="hidden"></div>
            <button class="btn btn-reset" id="resetBtn">Terminar y Reiniciar Sesi√≥n</button>
        </div>

        <div id="history-card" class="card hidden">
            <h2><span class="icon">üìã</span> Historial de Operaciones</h2>
            <div id="tableContent"></div>
        </div>
    </div>

    <script>
        const state = {
            initialBalance: 0, winRate: 0, totalOps: 0, winsNeeded: 0, minInvestment: 1, 
            sessionProfitGoal: 20, stopLossPercent: 25, stopLossTriggerAmount: 0,
            profitPerWin: 0, currentBalance: 0, lossesToRecover: 0,
            operationNumber: 1, winCount: 0, lastInvestment: 0,
            history: []
        };

        const ui = {
            elements: {
                setupCard: document.getElementById('setup-card'),
                liveCard: document.getElementById('live-card'),
                historyCard: document.getElementById('history-card'),
                operationLabel: document.getElementById('operation-label'),
                investmentAmount: document.getElementById('investment-amount'),
                livePanelContent: document.getElementById('live-panel-content'),
                sessionEndMessage: document.getElementById('session-end-message'),
                tableContent: document.getElementById('tableContent'),
                resumeBtn: document.getElementById('resumeBtn')
            },
            updateLivePanel(opNum, totalOps, amountText) {
                this.elements.operationLabel.innerText = `OPERACI√ìN #${opNum} de ${totalOps}`;
                this.elements.investmentAmount.innerText = amountText;
            },
            showEndMessage(isVictory, message) {
                this.elements.livePanelContent.classList.add('hidden');
                const msgDiv = this.elements.sessionEndMessage;
                msgDiv.innerText = message;
                msgDiv.className = isVictory ? 'victory-message' : 'loss-message';
                msgDiv.classList.remove('hidden');
            },
            renderHistoryTable(history) {
                let tableHTML = `<table><thead><tr><th>Op#</th><th>Invertiste</th><th>Resultado</th><th>Ganancia/P√©rdida</th><th>Balance Final</th></tr></thead><tbody>`;
                history.forEach(op => {
                    const rowClass = op.result === 'WIN' ? 'win-row' : 'loss-row';
                    const resultColor = op.netResult >= 0 ? 'var(--color-secondary)' : 'var(--color-loss)';
                    tableHTML += `<tr class="${rowClass}">
                        <td>${op.op}</td><td>$${op.investment.toFixed(2)}</td>
                        <td>${op.result}</td><td style="color: ${resultColor}">$${op.netResult.toFixed(2)}</td>
                        <td>$${op.balance.toFixed(2)}</td></tr>`;
                });
                tableHTML += '</tbody></table>';
                this.elements.tableContent.innerHTML = tableHTML;
            },
            showLiveMode() {
                this.elements.setupCard.classList.add('hidden');
                this.elements.liveCard.classList.remove('hidden');
                this.elements.historyCard.classList.remove('hidden');
            },
            showSetupMode() {
                this.elements.setupCard.classList.remove('hidden');
                this.elements.liveCard.classList.add('hidden');
                this.elements.historyCard.classList.add('hidden');
                this.elements.livePanelContent.classList.remove('hidden');
                this.elements.sessionEndMessage.classList.add('hidden');
                this.elements.tableContent.innerHTML = '';
            }
        };

        const sessionManager = {
            start() {
                try {
                    state.initialBalance = parseFloat(document.getElementById('balance').value);
                    state.sessionProfitGoal = parseFloat(document.getElementById('sessionProfitGoal').value);
                    state.stopLossPercent = parseFloat(document.getElementById('stopLossPercent').value);
                    state.winRate = parseFloat(document.getElementById('winRate').value) / 100;
                    state.totalOps = parseInt(document.getElementById('totalOps').value);
                    state.winsNeeded = parseInt(document.getElementById('winsNeeded').value);
                    state.minInvestment = parseFloat(document.getElementById('minInvestment').value);
                    
                    if ([state.initialBalance, state.sessionProfitGoal, state.stopLossPercent, state.winRate, state.totalOps, state.winsNeeded, state.minInvestment].some(isNaN) || state.winsNeeded >= state.totalOps) {
                        throw new Error('Valores inv√°lidos.');
                    }
                } catch (e) {
                    alert('Error en la configuraci√≥n: ' + e.message);
                    return;
                }

                state.currentBalance = state.initialBalance;
                state.stopLossTriggerAmount = state.initialBalance * (1 - (state.stopLossPercent / 100));
                const sessionTargetProfit = state.initialBalance * (state.sessionProfitGoal / 100);
                state.profitPerWin = sessionTargetProfit / state.winsNeeded;
                
                ui.showLiveMode();
                this.calculateNextInvestment();
            },
            calculateNextInvestment() {
                if (state.currentBalance <= 0) { this.end(false, "Capital Agotado. Sesi√≥n terminada."); return; }
                if (state.operationNumber > state.totalOps) { this.end(false, "L√≠mite de operaciones alcanzado."); return; }

                const calculatedInvestment = (state.lossesToRecover + state.profitPerWin) / state.winRate;
                const finalInvestment = Math.max(calculatedInvestment, state.minInvestment);
                state.lastInvestment = Math.min(finalInvestment, state.currentBalance);
                
                ui.updateLivePanel(state.operationNumber, state.totalOps, `$${state.lastInvestment.toFixed(2)}`);
            },
            logResult(isWin) {
                const investment = state.lastInvestment;
                const netResult = isWin ? investment * state.winRate : -investment;
                state.currentBalance += netResult;

                state.history.push({
                    op: state.operationNumber, investment, result: isWin ? 'WIN' : 'LOSS',
                    netResult, balance: state.currentBalance
                });

                if (isWin) {
                    state.winCount++;
                    state.lossesToRecover = 0;
                } else {
                    state.lossesToRecover += investment;
                }
                
                localStorage.setItem('tradingSessionState', JSON.stringify(state));
                ui.renderHistoryTable(state.history);

                if (state.currentBalance <= state.stopLossTriggerAmount) { this.end(false, "Stop-Loss alcanzado. Sesi√≥n terminada para proteger capital."); return; }
                if (state.winCount >= state.winsNeeded) { this.end(true, "¬°Take Profit alcanzado! Sesi√≥n finalizada con √©xito."); return; }
                
                state.operationNumber++;
                this.calculateNextInvestment();
            },
            end(isVictory, message) {
                localStorage.removeItem('tradingSessionState');
                ui.showEndMessage(isVictory, message);
            },
            resume(savedState) {
                Object.assign(state, savedState);
                ui.showLiveMode();
                ui.renderHistoryTable(state.history);
                this.calculateNextInvestment();
            },
            reset() {
                localStorage.removeItem('tradingSessionState');
                Object.assign(state, {
                    initialBalance: 0, winRate: 0, totalOps: 0, winsNeeded: 0, minInvestment: 1, 
                    sessionProfitGoal: 20, stopLossPercent: 25, stopLossTriggerAmount: 0,
                    profitPerWin: 0, currentBalance: 0, lossesToRecover: 0,
                    operationNumber: 1, winCount: 0, lastInvestment: 0,
                    history: []
                });
                ui.showSetupMode();
                ui.elements.resumeBtn.classList.add('hidden');
            }
        };

        const app = {
            init() {
                document.getElementById('startBtn').addEventListener('click', () => sessionManager.start());
                document.getElementById('winBtn').addEventListener('click', () => sessionManager.logResult(true));
                document.getElementById('lossBtn').addEventListener('click', () => sessionManager.logResult(false));
                document.getElementById('resetBtn').addEventListener('click', () => sessionManager.reset());
                ui.elements.resumeBtn.addEventListener('click', () => {
                    const savedState = JSON.parse(localStorage.getItem('tradingSessionState'));
                    if (savedState) {
                        sessionManager.resume(savedState);
                    }
                });

                // Check for a saved session on page load
                const savedState = localStorage.getItem('tradingSessionState');
                if (savedState) {
                    ui.elements.resumeBtn.classList.remove('hidden');
                }
            }
        };

        app.init();
    </script>
</body>
</html>

